from scrapy.spider import BaseSpider
from scrapy.http import Request,FormRequest
from scrapy.selector import Selector
import json
import csv
import datetime
import re
import sys

reload(sys)
sys.setdefaultencoding('utf8')

class WorldBank(BaseSpider):
        name = "world_star"
        start_urls = ['https://star.worldbank.org/corruption-cases/assetrecovery/']

        def __init__(self, *args, **kwargs):
                self.headers = ['Case Name', 'Jurisdiction of Settlement', 'Type of Settlement', 'Monetary Sanctions', 'Offenses-Alleged', 'Summary']
                oupf1 = open('world_stars_settlements-%s.csv'  % (str(datetime.date.today())), 'wb+')
                self.csv_file  = csv.writer(oupf1)
                self.csv_file.writerow(self.headers)
		self.headings = ['Case title', 'Jurisdiction of Origin', 'UNCAC Offenses Implicated', 'Money laundering Implicated', 'Legal Basis for Asset Recovery', 'Contributing Factors in Asset Recovery', 'Assets Adjudicated/Not Yet Returned (USD)', 'Case Summary', 'Disposition of Criminal Case(s)']
        	oupf2 = open('world_stars_assets-%s.csv' %(str(datetime.date.today())), 'wb+')
        	self.document_file = csv.writer(oupf2)
        	self.document_file.writerow(self.headings)

        def parse(self, response):
                sel = Selector(response)
		settlements = ''.join(sel.xpath('//section[@id="block-facetapi-60wthpqk1klbiwro0hdjojlrqgsm7zzv"]//ul[@id="facetapi-facet-apachesolrstar-1b-block-bundle"]/li[1]/a/@href').extract())
		if settlements:
			settle_url = 'https://star.worldbank.org' + settlements
			yield Request(settle_url, callback=self.parse_settlements)

		asset_recovery = ''.join(sel.xpath('//section[@id="block-facetapi-60wthpqk1klbiwro0hdjojlrqgsm7zzv"]//ul[@id="facetapi-facet-apachesolrstar-1b-block-bundle"]/li[2]/a/@href').extract())
		if asset_recovery:
			asset_url = 'https://star.worldbank.org' + asset_recovery
			yield Request(asset_url, callback=self.parse_assests)

	def parse_settlements(self, response):	
	    headers = {
	    'origin': 'https://star.worldbank.org',
	    'accept-encoding': 'gzip, deflate, br',
	    'accept-language': 'en-GB,en-US;q=0.9,en;q=0.8',
	    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36',
	    'content-type': 'application/x-www-form-urlencoded; charset=UTF-8',
	    'accept': '*/*',
	    'referer': 'https://star.worldbank.org/corruption-cases/assetrecovery/',
	    'authority': 'star.worldbank.org',
	    'x-requested-with': 'XMLHttpRequest',
	    }
	    data = [
	  ('entity_ids[arw][]', '18426'),
	  ('entity_ids[arw][]', '18427'),
	  ('entity_ids[arw][]', '18428'),
	  ('entity_ids[arw][]', '18429'),
	  ('entity_ids[arw][]', '18430'),
	  ('entity_ids[arw][]', '18431'),
	  ('entity_ids[arw][]', '18432'),
	  ('entity_ids[arw][]', '18433'),
	  ('entity_ids[arw][]', '18434'),
	  ('entity_ids[arw][]', '18435'),
	  ('entity_ids[arw][]', '18436'),
	  ('entity_ids[arw][]', '18437'),
	  ('entity_ids[arw][]', '18438'),
	  ('entity_ids[arw][]', '18439'),
	  ('entity_ids[arw][]', '18440'),
	  ('entity_ids[arw][]', '18441'),
	  ('entity_ids[arw][]', '18442'),
	  ('entity_ids[arw][]', '18443'),
	  ('entity_ids[arw][]', '18444'),
	  ('entity_ids[arw][]', '18445'),
	  ('entity_ids[arw][]', '18446'),
	  ('entity_ids[arw][]', '18447'),
	  ('entity_ids[arw][]', '18448'),
	  ('entity_ids[arw][]', '18449'),
	  ('entity_ids[arw][]', '18450'),
	  ('entity_ids[arw][]', '18451'),
	  ('entity_ids[arw][]', '18452'),
	  ('entity_ids[arw][]', '18453'),
	  ('entity_ids[arw][]', '18454'),
	  ('entity_ids[arw][]', '18455'),
	  ('entity_ids[arw][]', '18456'),
	  ('entity_ids[arw][]', '18457'),
	  ('entity_ids[arw][]', '18458'),
	  ('entity_ids[arw][]', '18459'),
	  ('entity_ids[arw][]', '18461'),
	  ('entity_ids[arw][]', '18462'),
	  ('entity_ids[arw][]', '18463'),
	  ('entity_ids[arw][]', '18464'),
	  ('entity_ids[arw][]', '18465'),
	  ('entity_ids[arw][]', '18466'),
	  ('entity_ids[arw][]', '18467'),
	  ('entity_ids[arw][]', '18468'),
	  ('entity_ids[arw][]', '18469'),
	  ('entity_ids[arw][]', '18470'),
	  ('entity_ids[arw][]', '18471'),
	  ('entity_ids[arw][]', '18472'),
	  ('entity_ids[arw][]', '18473'),
	  ('entity_ids[arw][]', '18474'),
	  ('entity_ids[arw][]', '18475'),
	  ('entity_ids[arw][]', '18476'),
	  ('entity_ids[arw][]', '18477'),
	  ('entity_ids[arw][]', '18478'),
	  ('entity_ids[arw][]', '18479'),
	  ('entity_ids[arw][]', '18482'),
	  ('entity_ids[arw][]', '18483'),
	  ('entity_ids[arw][]', '18484'),
	  ('entity_ids[arw][]', '18485'),
	  ('entity_ids[arw][]', '18486'),
	  ('entity_ids[arw][]', '18487'),
	  ('entity_ids[arw][]', '18489'),
	  ('entity_ids[arw][]', '18490'),
	  ('entity_ids[arw][]', '18491'),
	  ('entity_ids[arw][]', '18492'),
	  ('entity_ids[arw][]', '18493'),
	  ('entity_ids[arw][]', '18494'),
	  ('entity_ids[arw][]', '18495'),
	  ('entity_ids[arw][]', '18496'),
	  ('entity_ids[arw][]', '18497'),
	  ('entity_ids[arw][]', '18498'),
	  ('entity_ids[arw][]', '18499'),
	  ('entity_ids[arw][]', '18500'),
	  ('entity_ids[arw][]', '18501'),
	  ('entity_ids[arw][]', '18502'),
	  ('entity_ids[arw][]', '18503'),
	  ('entity_ids[arw][]', '18504'),
	  ('entity_ids[arw][]', '18505'),
	  ('entity_ids[arw][]', '18506'),
	  ('entity_ids[arw][]', '18507'),
	  ('entity_ids[arw][]', '18508'),
	  ('entity_ids[arw][]', '18509'),
	  ('entity_ids[arw][]', '18510'),
	  ('entity_ids[arw][]', '18511'),
	  ('entity_ids[arw][]', '18512'),
	  ('entity_ids[arw][]', '18513'),
	  ('entity_ids[arw][]', '18514'),
	  ('entity_ids[arw][]', '18515'),
	  ('entity_ids[arw][]', '18516'),
	  ('entity_ids[arw][]', '18517'),
	  ('entity_ids[arw][]', '18518'),
	  ('entity_ids[arw][]', '18521'),
	  ('entity_ids[arw][]', '18522'),
	  ('entity_ids[arw][]', '18523'),
	  ('entity_ids[arw][]', '18524'),
	  ('entity_ids[arw][]', '18525'),
	  ('entity_ids[arw][]', '18526'),
	  ('entity_ids[arw][]', '18527'),
	  ('entity_ids[arw][]', '18528'),
	  ('entity_ids[arw][]', '18529'),
	  ('entity_ids[arw][]', '18530'),
	  ('entity_ids[arw][]', '18531'),
	  ('entity_ids[arw][]', '18532'),
	  ('entity_ids[arw][]', '18533'),
	  ('entity_ids[arw][]', '18534'),
	  ('entity_ids[arw][]', '18535'),
	  ('entity_ids[arw][]', '18536'),
	  ('entity_ids[arw][]', '18537'),
	  ('entity_ids[arw][]', '18538'),
	  ('entity_ids[arw][]', '18539'),
	  ('entity_ids[arw][]', '18540'),
	  ('entity_ids[arw][]', '18541'),
	  ('entity_ids[arw][]', '18542'),
	  ('entity_ids[arw][]', '18543'),
	  ('entity_ids[arw][]', '18544'),
	  ('entity_ids[arw][]', '18546'),
	  ('entity_ids[arw][]', '18547'),
	  ('entity_ids[arw][]', '18548'),
	  ('entity_ids[arw][]', '18549'),
	  ('entity_ids[arw][]', '18551'),
	  ('entity_ids[arw][]', '18552'),
	  ('entity_ids[arw][]', '18553'),
	  ('entity_ids[arw][]', '18554'),
	  ('entity_ids[arw][]', '18555'),
	  ('entity_ids[arw][]', '18556'),
	  ('entity_ids[arw][]', '18557'),
	  ('entity_ids[arw][]', '18558'),
	  ('entity_ids[arw][]', '18559'),
	  ('entity_ids[arw][]', '18560'),
	  ('entity_ids[arw][]', '18561'),
	  ('entity_ids[arw][]', '18562'),
	  ('entity_ids[arw][]', '18563'),
	  ('entity_ids[arw][]', '18564'),
	  ('entity_ids[arw][]', '18565'),
	  ('entity_ids[arw][]', '18566'),
	  ('entity_ids[arw][]', '18567'),
	  ('entity_ids[arw][]', '18568'),
	  ('entity_ids[arw][]', '18569'),
	  ('entity_ids[arw][]', '18570'),
	  ('entity_ids[arw][]', '18571'),
	  ('entity_ids[arw][]', '18572'),
	  ('entity_ids[arw][]', '18573'),
	  ('entity_ids[arw][]', '18574'),
	  ('entity_ids[arw][]', '18575'),
	  ('entity_ids[arw][]', '18576'),
	  ('entity_ids[arw][]', '18577'),
	  ('entity_ids[arw][]', '18578'),
	  ('entity_ids[arw][]', '18579'),
	  ('entity_ids[arw][]', '18580'),
	  ('entity_ids[arw][]', '18581'),
	  ('entity_ids[arw][]', '18584'),
	  ('entity_ids[arw][]', '18585'),
	  ('entity_ids[arw][]', '18586'),
	  ('entity_ids[arw][]', '18587'),
	  ('entity_ids[arw][]', '18588'),
	  ('entity_ids[arw][]', '18589'),
	  ('entity_ids[arw][]', '18590'),
	  ('entity_ids[arw][]', '18591'),
	  ('entity_ids[arw][]', '18592'),
	  ('entity_ids[arw][]', '18593'),
	  ('entity_ids[arw][]', '18594'),
	  ('entity_ids[arw][]', '18595'),
	  ('entity_ids[arw][]', '18596'),
	  ('entity_ids[arw][]', '18597'),
	  ('entity_ids[arw][]', '18598'),
	  ('entity_ids[arw][]', '18599'),
	  ('entity_ids[arw][]', '18600'),
	  ('entity_ids[arw][]', '18601'),
	  ('entity_ids[arw][]', '18602'),
	  ('entity_ids[arw][]', '18603'),
	  ('entity_ids[arw][]', '18604'),
	  ('entity_ids[arw][]', '19571'),
	  ('entity_ids[arw][]', '19572'),
	  ('entity_ids[arw][]', '19573'),
	  ('entity_ids[arw][]', '19574'),
	  ('entity_ids[arw][]', '19575'),
	  ('entity_ids[arw][]', '19576'),
	  ('entity_ids[arw][]', '19577'),
	  ('entity_ids[arw][]', '19578'),
	  ('entity_ids[arw][]', '19579'),
	  ('entity_ids[arw][]', '19580'),
	  ('entity_ids[arw][]', '19581'),
	  ('entity_ids[arw][]', '19582'),
	  ('entity_ids[arw][]', '19583'),
	  ('entity_ids[arw][]', '19584'),
	  ('entity_ids[arw][]', '19585'),
	  ('entity_ids[arw][]', '19586'),
	  ('entity_ids[arw][]', '19587'),
	  ('entity_ids[arw][]', '19588'),
	  ('entity_ids[arw][]', '19589'),
	  ('entity_ids[arw][]', '19590'),
	  ('entity_ids[arw][]', '19591'),
	  ('entity_ids[arw][]', '19592'),
	  ('entity_ids[arw][]', '19594'),
	  ('entity_ids[arw][]', '19595'),
	  ('entity_ids[arw][]', '19596'),
	  ('entity_ids[arw][]', '19597'),
	  ('entity_ids[arw][]', '19598'),
	  ('entity_ids[arw][]', '19599'),
	  ('entity_ids[arw][]', '19600'),
	  ('entity_ids[arw][]', '20306'),
	  ('entity_ids[arw][]', '20307'),
	  ('entity_ids[arw][]', '20308'),
	  ('entity_ids[arw][]', '20309'),
	  ('entity_ids[arw][]', '20310'),
	  ('entity_ids[arw][]', '20311'),
	  ('entity_ids[arw][]', '20312'),
	  ('entity_ids[arw][]', '20313'),
	  ('entity_ids[arw][]', '20314'),
	  ('entity_ids[arw][]', '20315'),
	  ('entity_ids[arw][]', '20316'),
	  ('entity_ids[arw][]', '20317'),
	  ('entity_ids[arw][]', '20318'),
	  ('entity_ids[arw][]', '20319'),
	  ('entity_ids[arw][]', '20320'),
	  ('entity_ids[arw][]', '20321'),
	  ('entity_ids[arw][]', '20322'),
	  ('entity_ids[arw][]', '20324'),
	  ('entity_ids[arw][]', '20325'),
	  ('entity_ids[arw][]', '20326'),
	  ('entity_ids[arw][]', '20327'),
	  ('entity_ids[arw][]', '20328'),
	  ('entity_ids[arw][]', '20329'),
	  ('entity_ids[arw][]', '20330'),
	  ('entity_ids[arw][]', '20331'),
	  ('entity_ids[arw][]', '20332'),
	  ('entity_ids[arw][]', '20333'),
	  ('entity_ids[arw][]', '20334'),
	  ('entity_ids[arw][]', '20336'),
	  ('entity_ids[arw][]', '20337'),
	  ('entity_ids[arw][]', '20338'),
	  ('entity_ids[arw][]', '20339'),
	  ('entity_ids[arw][]', '20340'),
	  ('entity_ids[arw][]', '20341'),
	  ('entity_ids[arw][]', '20342'),
	  ('entity_ids[arw][]', '20345'),
	  ('entity_ids[arw][]', '20346'),
	  ('entity_ids[arw][]', '20349'),
	  ('entity_ids[arw][]', '20487'),
	  ('entity_ids[arw][]', '20488'),
	  ('entity_ids[arw][]', '20489'),
	  ('entity_ids[arw][]', '20490'),
	  ('entity_ids[arw][]', '20494'),
	  ('entity_ids[arw][]', '20496'),
	  ('entity_ids[arw][]', '20497'),
	  ('entity_ids[arw][]', '20498'),
	  ('entity_ids[arw][]', '20499'),
	  ('entity_ids[settlements][]', '19776'),
	  ('entity_ids[settlements][]', '19777'),
	  ('entity_ids[settlements][]', '19778'),
	  ('entity_ids[settlements][]', '19779'),
	  ('entity_ids[settlements][]', '19780'),
	  ('entity_ids[settlements][]', '19781'),
	  ('entity_ids[settlements][]', '19782'),
	  ('entity_ids[settlements][]', '19783'),
	  ('entity_ids[settlements][]', '19784'),
	  ('entity_ids[settlements][]', '19785'),
	  ('entity_ids[settlements][]', '19786'),
	  ('entity_ids[settlements][]', '19787'),
	  ('entity_ids[settlements][]', '19788'),
          ('entity_ids[settlements][]', '19779'),
	  ('entity_ids[settlements][]', '19780'),
	  ('entity_ids[settlements][]', '19781'),
	  ('entity_ids[settlements][]', '19782'),
	  ('entity_ids[settlements][]', '19783'),
	  ('entity_ids[settlements][]', '19784'),
	  ('entity_ids[settlements][]', '19785'),
	  ('entity_ids[settlements][]', '19786'),
	  ('entity_ids[settlements][]', '19787'),
	  ('entity_ids[settlements][]', '19788'),
	  ('entity_ids[settlements][]', '19789'),
	  ('entity_ids[settlements][]', '19790'),
	  ('entity_ids[settlements][]', '19791'),
	  ('entity_ids[settlements][]', '19792'),
	  ('entity_ids[settlements][]', '19793'),
	  ('entity_ids[settlements][]', '19794'),
	  ('entity_ids[settlements][]', '19795'),
	  ('entity_ids[settlements][]', '19796'),
	  ('entity_ids[settlements][]', '19797'),
	  ('entity_ids[settlements][]', '19798'),
	  ('entity_ids[settlements][]', '19799'),
	  ('entity_ids[settlements][]', '19800'),
	  ('entity_ids[settlements][]', '19801'),
	  ('entity_ids[settlements][]', '19802'),
	  ('entity_ids[settlements][]', '19803'),
	  ('entity_ids[settlements][]', '19804'),
	  ('entity_ids[settlements][]', '19805'),
	  ('entity_ids[settlements][]', '19806'),
	  ('entity_ids[settlements][]', '19807'),
	  ('entity_ids[settlements][]', '19808'),
	  ('entity_ids[settlements][]', '19809'),
	  ('entity_ids[settlements][]', '19810'),
	  ('entity_ids[settlements][]', '19811'),
	  ('entity_ids[settlements][]', '19812'),
	  ('entity_ids[settlements][]', '19813'),
	  ('entity_ids[settlements][]', '19814'),
	  ('entity_ids[settlements][]', '19815'),
	  ('entity_ids[settlements][]', '19816'),
	  ('entity_ids[settlements][]', '19817'),
	  ('entity_ids[settlements][]', '19818'),
	  ('entity_ids[settlements][]', '19819'),
	  ('entity_ids[settlements][]', '19820'),
	  ('entity_ids[settlements][]', '19821'),
	  ('entity_ids[settlements][]', '19822'),
	  ('entity_ids[settlements][]', '19823'),
	  ('entity_ids[settlements][]', '19824'),
	  ('entity_ids[settlements][]', '19825'),
	  ('entity_ids[settlements][]', '19827'),
	  ('entity_ids[settlements][]', '19828'),
	  ('entity_ids[settlements][]', '19829'),
	  ('entity_ids[settlements][]', '19830'),
	  ('entity_ids[settlements][]', '19831'),
	  ('entity_ids[settlements][]', '19832'),
	  ('entity_ids[settlements][]', '19833'),
	  ('entity_ids[settlements][]', '19834'),
	  ('entity_ids[settlements][]', '19835'),
	  ('entity_ids[settlements][]', '19836'),
	  ('entity_ids[settlements][]', '19837'),
	  ('entity_ids[settlements][]', '19838'),
	  ('entity_ids[settlements][]', '19839'),
	  ('entity_ids[settlements][]', '19840'),
	  ('entity_ids[settlements][]', '19841'),
	  ('entity_ids[settlements][]', '19842'),
	  ('entity_ids[settlements][]', '19843'),
	  ('entity_ids[settlements][]', '19844'),
	  ('entity_ids[settlements][]', '19845'),
	  ('entity_ids[settlements][]', '19846'),
	  ('entity_ids[settlements][]', '19847'),
	  ('entity_ids[settlements][]', '19848'),
	  ('entity_ids[settlements][]', '19849'),
	  ('entity_ids[settlements][]', '19850'),
	  ('entity_ids[settlements][]', '19851'),
	  ('entity_ids[settlements][]', '19852'),
	  ('entity_ids[settlements][]', '19853'),
	  ('entity_ids[settlements][]', '19854'),
	  ('entity_ids[settlements][]', '19855'),
	  ('entity_ids[settlements][]', '19856'),
	  ('entity_ids[settlements][]', '19857'),
	  ('entity_ids[settlements][]', '19858'),
	  ('entity_ids[settlements][]', '19859'),
	  ('entity_ids[settlements][]', '19860'),
	  ('entity_ids[settlements][]', '19861'),
	  ('entity_ids[settlements][]', '19862'),
	  ('entity_ids[settlements][]', '19863'),
	  ('entity_ids[settlements][]', '19864'),
	  ('entity_ids[settlements][]', '19865'),
	  ('entity_ids[settlements][]', '19866'),
	  ('entity_ids[settlements][]', '19867'),
	  ('entity_ids[settlements][]', '19868'),
	  ('entity_ids[settlements][]', '19869'),
	  ('entity_ids[settlements][]', '19870'),
	  ('entity_ids[settlements][]', '19871'),
	  ('entity_ids[settlements][]', '19872'),
	  ('entity_ids[settlements][]', '19873'),
	  ('entity_ids[settlements][]', '19874'),
	  ('entity_ids[settlements][]', '19875'),
	  ('entity_ids[settlements][]', '19876'),
	  ('entity_ids[settlements][]', '19877'),
	  ('entity_ids[settlements][]', '19878'),
	  ('entity_ids[settlements][]', '19879'),
	  ('entity_ids[settlements][]', '19880'),
	  ('entity_ids[settlements][]', '19881'),
	  ('entity_ids[settlements][]', '19882'),
	  ('entity_ids[settlements][]', '19883'),
	  ('entity_ids[settlements][]', '19884'),
	  ('entity_ids[settlements][]', '19885'),
	  ('entity_ids[settlements][]', '19886'),
	  ('entity_ids[settlements][]', '19887'),
	  ('entity_ids[settlements][]', '19888'),
	  ('entity_ids[settlements][]', '19889'),
	  ('entity_ids[settlements][]', '19890'),
	  ('entity_ids[settlements][]', '19891'),
	  ('entity_ids[settlements][]', '19892'),
	  ('entity_ids[settlements][]', '19893'),
	  ('entity_ids[settlements][]', '19894'),
	  ('entity_ids[settlements][]', '19895'),
	  ('entity_ids[settlements][]', '19896'),
	  ('entity_ids[settlements][]', '19897'),
	  ('entity_ids[settlements][]', '19898'),
	  ('entity_ids[settlements][]', '19899'),
	  ('entity_ids[settlements][]', '19900'),
	  ('entity_ids[settlements][]', '19901'),
	  ('entity_ids[settlements][]', '19902'),
	  ('entity_ids[settlements][]', '19903'),
	  ('entity_ids[settlements][]', '19904'),
	  ('entity_ids[settlements][]', '19905'),
	  ('entity_ids[settlements][]', '19906'),
	  ('entity_ids[settlements][]', '19907'),
	  ('entity_ids[settlements][]', '19908'),
	  ('entity_ids[settlements][]', '19909'),
	  ('entity_ids[settlements][]', '19910'),
	  ('entity_ids[settlements][]', '19911'),
	  ('entity_ids[settlements][]', '19912'),
	  ('entity_ids[settlements][]', '19913'),
	  ('entity_ids[settlements][]', '19914'),
	  ('entity_ids[settlements][]', '19915'),
	  ('entity_ids[settlements][]', '19916'),
	  ('entity_ids[settlements][]', '19917'),
	  ('entity_ids[settlements][]', '19918'),
	  ('entity_ids[settlements][]', '19919'),
	  ('entity_ids[settlements][]', '19920'),
	  ('entity_ids[settlements][]', '19921'),
	  ('entity_ids[settlements][]', '19922'),
	  ('entity_ids[settlements][]', '19923'),
	  ('entity_ids[settlements][]', '19924'),
	  ('entity_ids[settlements][]', '19926'),
	  ('entity_ids[settlements][]', '19928'),
	  ('entity_ids[settlements][]', '19929'),
	  ('entity_ids[settlements][]', '19968'),
	  ('entity_ids[settlements][]', '19969'),
	  ('entity_ids[settlements][]', '19970'),
	  ('entity_ids[settlements][]', '19971'),
	  ('entity_ids[settlements][]', '19972'),
	  ('entity_ids[settlements][]', '19973'),
	  ('entity_ids[settlements][]', '19974'),
	  ('entity_ids[settlements][]', '19975'),
	  ('entity_ids[settlements][]', '19976'),
	  ('entity_ids[settlements][]', '19977'),
	  ('entity_ids[settlements][]', '19979'),
	  ('entity_ids[settlements][]', '19980'),
	  ('entity_ids[settlements][]', '19981'),
	  ('entity_ids[settlements][]', '19982'),
	  ('entity_ids[settlements][]', '19983'),
	  ('entity_ids[settlements][]', '19984'),
	  ('entity_ids[settlements][]', '19985'),
	  ('entity_ids[settlements][]', '19986'),
	  ('entity_ids[settlements][]', '19987'),
	  ('entity_ids[settlements][]', '19988'),
	  ('entity_ids[settlements][]', '19989'),
	  ('entity_ids[settlements][]', '19990'),
	  ('entity_ids[settlements][]', '19991'),
	  ('entity_ids[settlements][]', '19992'),
	  ('entity_ids[settlements][]', '19993'),
	  ('entity_ids[settlements][]', '19994'),
	  ('entity_ids[settlements][]', '19995'),
	  ('entity_ids[settlements][]', '19996'),
	  ('entity_ids[settlements][]', '19997'),
	  ('entity_ids[settlements][]', '19998'),
	  ('entity_ids[settlements][]', '19999'),
	  ('entity_ids[settlements][]', '20000'),
	  ('entity_ids[settlements][]', '20001'),
	  ('entity_ids[settlements][]', '20002'),
	  ('entity_ids[settlements][]', '20003'),
	  ('entity_ids[settlements][]', '20004'),
	  ('entity_ids[settlements][]', '20005'),
	  ('entity_ids[settlements][]', '20006'),
	  ('entity_ids[settlements][]', '20007'),
	  ('entity_ids[settlements][]', '20008'),
	  ('entity_ids[settlements][]', '20009'),
	  ('entity_ids[settlements][]', '20010'),
	  ('entity_ids[settlements][]', '20011'),
	  ('entity_ids[settlements][]', '20012'),
	  ('entity_ids[settlements][]', '20013'),
	  ('entity_ids[settlements][]', '20014'),
	  ('entity_ids[settlements][]', '20015'),
	  ('entity_ids[settlements][]', '20016'),
	  ('entity_ids[settlements][]', '20017'),
	  ('entity_ids[settlements][]', '20026'),
	  ('entity_ids[settlements][]', '20027'),
	  ('entity_ids[settlements][]', '20028'),
	  ('entity_ids[settlements][]', '20029'),
	  ('entity_ids[settlements][]', '20030'),
	  ('entity_ids[settlements][]', '20031'),
	  ('entity_ids[settlements][]', '20032'),
	  ('entity_ids[settlements][]', '20033'),
	  ('entity_ids[settlements][]', '20034'),
	  ('entity_ids[settlements][]', '20035'),
	  ('entity_ids[settlements][]', '20036'),
	  ('entity_ids[settlements][]', '20037'),
	  ('entity_ids[settlements][]', '20038'),
	  ('entity_ids[settlements][]', '20039'),
	  ('entity_ids[settlements][]', '20040'),
	  ('entity_ids[settlements][]', '20041'),
	  ('entity_ids[settlements][]', '20042'),
	  ('entity_ids[settlements][]', '20043'),
	  ('entity_ids[settlements][]', '20044'),
	  ('entity_ids[settlements][]', '20045'),
	  ('entity_ids[settlements][]', '20046'),
	  ('entity_ids[settlements][]', '20047'),
	  ('entity_ids[settlements][]', '20048'),
	  ('entity_ids[settlements][]', '20049'),
	  ('entity_ids[settlements][]', '20050'),
	  ('entity_ids[settlements][]', '20051'),
	  ('entity_ids[settlements][]', '20052'),
	  ('entity_ids[settlements][]', '20053'),
	  ('entity_ids[settlements][]', '20054'),
	  ('entity_ids[settlements][]', '20055'),
	  ('entity_ids[settlements][]', '20056'),
	  ('entity_ids[settlements][]', '20057'),
	  ('entity_ids[settlements][]', '20058'),
	  ('entity_ids[settlements][]', '20059'),
	  ('entity_ids[settlements][]', '20060'),
	  ('entity_ids[settlements][]', '20061'),
	  ('entity_ids[settlements][]', '20062'),
	  ('entity_ids[settlements][]', '20063'),
	  ('entity_ids[settlements][]', '20064'),
	  ('entity_ids[settlements][]', '20065'),
	  ('entity_ids[settlements][]', '20066'),
	  ('entity_ids[settlements][]', '20067'),
	  ('entity_ids[settlements][]', '20068'),
	  ('entity_ids[settlements][]', '20069'),
	  ('entity_ids[settlements][]', '20070'),
	  ('entity_ids[settlements][]', '20071'),
	  ('entity_ids[settlements][]', '20072'),
	  ('entity_ids[settlements][]', '20073'),
	  ('entity_ids[settlements][]', '20074'),
	  ('entity_ids[settlements][]', '20075'),
	  ('entity_ids[settlements][]', '20100'),
	  ('entity_ids[settlements][]', '20101'),
	  ('entity_ids[settlements][]', '20102'),
	  ('entity_ids[settlements][]', '20103'),
	  ('entity_ids[settlements][]', '20104'),
	  ('entity_ids[settlements][]', '20105'),
	  ('entity_ids[settlements][]', '20106'),
	  ('entity_ids[settlements][]', '20107'),
	  ('entity_ids[settlements][]', '20108'),
	  ('entity_ids[settlements][]', '20109'),
	  ('entity_ids[settlements][]', '20110'),
	  ('entity_ids[settlements][]', '20111'),
	  ('entity_ids[settlements][]', '20112'),
	  ('entity_ids[settlements][]', '20113'),
	  ('entity_ids[settlements][]', '20114'),
	  ('entity_ids[settlements][]', '20115'),
	  ('entity_ids[settlements][]', '20116'),
	  ('entity_ids[settlements][]', '20117'),
	  ('entity_ids[settlements][]', '20118'),
	  ('entity_ids[settlements][]', '20119'),
	  ('entity_ids[settlements][]', '20120'),
	  ('entity_ids[settlements][]', '20121'),
	  ('entity_ids[settlements][]', '20122'),
	  ('entity_ids[settlements][]', '20123'),
	  ('entity_ids[settlements][]', '20124'),
	  ('entity_ids[settlements][]', '20125'),
	  ('entity_ids[settlements][]', '20126'),
	  ('entity_ids[settlements][]', '20127'),
	  ('entity_ids[settlements][]', '20128'),
	  ('entity_ids[settlements][]', '20129'),
	  ('entity_ids[settlements][]', '20130'),
	  ('entity_ids[settlements][]', '20131'),
	  ('entity_ids[settlements][]', '20132'),
	  ('entity_ids[settlements][]', '20134'),
	  ('entity_ids[settlements][]', '20135'),
	  ('entity_ids[settlements][]', '20136'),
	  ('entity_ids[settlements][]', '20137'),
	  ('entity_ids[settlements][]', '20138'),
	  ('entity_ids[settlements][]', '20139'),
	  ('entity_ids[settlements][]', '20140'),
	  ('entity_ids[settlements][]', '20141'),
	  ('entity_ids[settlements][]', '20142'),
	  ('entity_ids[settlements][]', '20143'),
	  ('entity_ids[settlements][]', '20144'),
	  ('entity_ids[settlements][]', '20145'),
	  ('entity_ids[settlements][]', '20146'),
	  ('entity_ids[settlements][]', '20147'),
	  ('entity_ids[settlements][]', '20148'),
	  ('entity_ids[settlements][]', '20149'),
	  ('entity_ids[settlements][]', '20150'),
	  ('entity_ids[settlements][]', '20151'),
	  ('entity_ids[settlements][]', '20152'),
	  ('entity_ids[settlements][]', '20153'),
	  ('entity_ids[settlements][]', '20154'),
	  ('entity_ids[settlements][]', '20155'),
	  ('entity_ids[settlements][]', '20156'),
	  ('entity_ids[settlements][]', '20157'),
	  ('entity_ids[settlements][]', '20158'),
	  ('entity_ids[settlements][]', '20159'),
	  ('entity_ids[settlements][]', '20160'),
	  ('entity_ids[settlements][]', '20161'),
	  ('entity_ids[settlements][]', '20162'),
	  ('entity_ids[settlements][]', '20163'),
	  ('entity_ids[settlements][]', '20164'),
	  ('entity_ids[settlements][]', '20165'),
	  ('entity_ids[settlements][]', '20166'),
	  ('entity_ids[settlements][]', '20167'),
	  ('entity_ids[settlements][]', '20168'),
	  ('entity_ids[settlements][]', '20169'),
	  ('entity_ids[settlements][]', '20170'),
	  ('entity_ids[settlements][]', '20171'),
	  ('entity_ids[settlements][]', '20172'),
	  ('entity_ids[settlements][]', '20173'),
	  ('entity_ids[settlements][]', '20174'),
	  ('entity_ids[settlements][]', '20175'),
	  ('entity_ids[settlements][]', '20176'),
	  ('entity_ids[settlements][]', '20177'),
	  ('entity_ids[settlements][]', '20178'),
	  ('entity_ids[settlements][]', '20179'),
	  ('entity_ids[settlements][]', '20180'),
	  ('entity_ids[settlements][]', '20181'),
	  ('entity_ids[settlements][]', '20182'),
	  ('entity_ids[settlements][]', '20183'),
	  ('entity_ids[settlements][]', '20184'),
	  ('entity_ids[settlements][]', '20185'),
	  ('entity_ids[settlements][]', '20186'),
	  ('entity_ids[settlements][]', '20187'),
	  ('entity_ids[settlements][]', '20188'),
	  ('entity_ids[settlements][]', '20189'),
	  ('entity_ids[settlements][]', '20190'),
	  ('entity_ids[settlements][]', '20191'),
	  ('entity_ids[settlements][]', '20192'),
	  ('entity_ids[settlements][]', '20193'),
	  ('entity_ids[settlements][]', '20194'),
	  ('entity_ids[settlements][]', '20195'),
	  ('entity_ids[settlements][]', '20196'),
	  ('entity_ids[settlements][]', '20197'),
	  ('entity_ids[settlements][]', '20198'),
	  ('entity_ids[settlements][]', '20199'),
	  ('entity_ids[settlements][]', '20200'),
	  ('entity_ids[settlements][]', '20201'),
	  ('entity_ids[settlements][]', '20202'),
	  ('entity_ids[settlements][]', '20203'),
	  ('entity_ids[settlements][]', '20204'),
	  ('entity_ids[settlements][]', '20205'),
	  ('entity_ids[settlements][]', '20206'),
	  ('entity_ids[settlements][]', '20207'),
	  ('entity_ids[settlements][]', '20208'),
	  ('entity_ids[settlements][]', '20209'),
	  ('entity_ids[settlements][]', '20210'),
	  ('entity_ids[settlements][]', '20211'),
	  ('entity_ids[settlements][]', '20212'),
	  ('entity_ids[settlements][]', '20213'),
	  ('entity_ids[settlements][]', '20214'),
	  ('entity_ids[settlements][]', '20215'),
	  ('entity_ids[settlements][]', '20216'),
	  ('entity_ids[settlements][]', '20217'),
	  ('entity_ids[settlements][]', '20218'),
	  ('entity_ids[settlements][]', '20219'),
	  ('entity_ids[settlements][]', '20220'),
	  ('entity_ids[settlements][]', '20221'),
	  ('entity_ids[settlements][]', '20222'),
	  ('entity_ids[settlements][]', '20223'),
	  ('entity_ids[settlements][]', '20224'),
	  ('entity_ids[settlements][]', '20225'),
	  ('entity_ids[settlements][]', '20226'),
	  ('entity_ids[settlements][]', '20227'),
	  ('entity_ids[settlements][]', '20228'),
	  ('entity_ids[settlements][]', '20229'),
	  ('entity_ids[settlements][]', '20230'),
	  ('entity_ids[settlements][]', '20231'),
	  ('entity_ids[settlements][]', '20232'),
	  ('entity_ids[settlements][]', '20233'),
	  ('entity_ids[settlements][]', '20234'),
	  ('entity_ids[settlements][]', '20235'),
	  ('entity_ids[settlements][]', '20236'),
	  ('entity_ids[settlements][]', '20237'),
	  ('entity_ids[settlements][]', '20238'),
	  ('entity_ids[settlements][]', '20239'),
	  ('entity_ids[settlements][]', '20240'),
	  ('entity_ids[settlements][]', '20241'),
	  ('entity_ids[settlements][]', '20242'),
	  ('entity_ids[settlements][]', '20243'),
	  ('entity_ids[settlements][]', '20244'),
	  ('entity_ids[settlements][]', '20245'),
	  ('entity_ids[settlements][]', '20246'),
	  ('entity_ids[settlements][]', '20302'),
	  ('entity_ids[settlements][]', '20350'),
	  ('entity_ids[settlements][]', '20351'),
	  ('entity_ids[settlements][]', '20352'),
	  ('entity_ids[settlements][]', '20353'),
	  ('entity_ids[settlements][]', '20354'),
	  ('entity_ids[settlements][]', '20355'),
	  ('entity_ids[settlements][]', '20356'),
	  ('entity_ids[settlements][]', '20357'),
	  ('entity_ids[settlements][]', '20358'),
	  ('entity_ids[settlements][]', '20359'),
	  ('entity_ids[settlements][]', '20360'),
	  ('entity_ids[settlements][]', '20361'),
	  ('entity_ids[settlements][]', '20362'),
	  ('entity_ids[settlements][]', '20363'),
	  ('entity_ids[settlements][]', '20364'),
	  ('entity_ids[settlements][]', '20365'),
	  ('entity_ids[settlements][]', '20366'),
	  ('entity_ids[settlements][]', '20367'),
	  ('entity_ids[settlements][]', '20368'),
	  ('entity_ids[settlements][]', '20369'),
	  ('entity_ids[settlements][]', '20370'),
	  ('entity_ids[settlements][]', '20371'),
	  ('entity_ids[settlements][]', '20372'),
	  ('entity_ids[settlements][]', '20373'),
	  ('entity_ids[settlements][]', '20374'),
	  ('entity_ids[settlements][]', '20375'),
	  ('entity_ids[settlements][]', '20376'),
	  ('entity_ids[settlements][]', '20377'),
	  ('entity_ids[settlements][]', '20378'),
	  ('entity_ids[settlements][]', '20379'),
	  ('entity_ids[settlements][]', '20380'),
	  ('entity_ids[settlements][]', '20381'),
	  ('entity_ids[settlements][]', '20382'),
	  ('entity_ids[settlements][]', '20383'),
	  ('entity_ids[settlements][]', '20384'),
	  ('entity_ids[settlements][]', '20385'),
	  ('entity_ids[settlements][]', '20386'),
	  ('entity_ids[settlements][]', '20387'),
	  ('entity_ids[settlements][]', '20388'),
	  ('entity_ids[settlements][]', '20389'),
	  ('entity_ids[settlements][]', '20390'),
	  ('entity_ids[settlements][]', '20391'),
	  ('entity_ids[settlements][]', '20392'),
	  ('entity_ids[settlements][]', '20393'),
	  ('entity_ids[settlements][]', '20394'),
	  ('entity_ids[settlements][]', '20395'),
	  ('entity_ids[settlements][]', '20396'),
	  ('entity_ids[settlements][]', '20397'),
	  ('entity_ids[settlements][]', '20398'),
	  ('entity_ids[settlements][]', '20399'),
	  ('entity_ids[settlements][]', '20400'),
	  ('entity_ids[settlements][]', '20401'),
	  ('entity_ids[settlements][]', '20402'),
	  ('entity_ids[settlements][]', '20403'),
	  ('entity_ids[settlements][]', '20404'),
	  ('entity_ids[settlements][]', '20405'),
	  ('entity_ids[settlements][]', '20406'),
	  ('entity_ids[settlements][]', '20407'),
	  ('entity_ids[settlements][]', '20408'),
	  ('entity_ids[settlements][]', '20409'),
	  ('entity_ids[settlements][]', '20410'),
	  ('entity_ids[settlements][]', '20411'),
	  ('entity_ids[settlements][]', '20412'),
	  ('entity_ids[settlements][]', '20413'),
	  ('entity_ids[settlements][]', '20414'),
	  ('entity_ids[settlements][]', '20415'),
	  ('entity_ids[settlements][]', '20416'),
	  ('entity_ids[settlements][]', '20417'),
	  ('entity_ids[settlements][]', '20418'),
	  ('entity_ids[settlements][]', '20419'),
	  ('entity_ids[settlements][]', '20420'),
	  ('entity_ids[settlements][]', '20421'),
	  ('entity_ids[settlements][]', '20422'),
	  ('entity_ids[settlements][]', '20423'),
	  ('entity_ids[settlements][]', '20424'),
	  ('entity_ids[settlements][]', '20425'),
	  ('entity_ids[settlements][]', '20426'),
	  ('entity_ids[settlements][]', '20427'),
	  ('entity_ids[settlements][]', '20428'),
	  ('entity_ids[settlements][]', '20429'),
	  ('entity_ids[settlements][]', '20430'),
	  ('entity_ids[settlements][]', '20431'),
	  ('entity_ids[settlements][]', '20432'),
	  ('entity_ids[settlements][]', '20433'),
	  ('entity_ids[settlements][]', '20434'),
	  ('entity_ids[settlements][]', '20435'),
	  ('entity_ids[settlements][]', '20436'),
	  ('entity_ids[settlements][]', '20437'),
	  ('entity_ids[settlements][]', '20438'),
	  ('entity_ids[settlements][]', '20439'),
	  ('entity_ids[settlements][]', '20440'),
	  ('entity_ids[settlements][]', '20441'),
	  ('entity_ids[settlements][]', '20442'),
	  ('entity_ids[settlements][]', '20443'),
	  ('entity_ids[settlements][]', '20444'),
	  ('entity_ids[settlements][]', '20445'),
	  ('entity_ids[settlements][]', '20446'),
	  ('entity_ids[settlements][]', '20447'),
	  ('entity_ids[settlements][]', '20448'),
	  ('entity_ids[settlements][]', '20449'),
	  ('entity_ids[settlements][]', '20450'),
	  ('entity_ids[settlements][]', '20451'),
	  ('entity_ids[settlements][]', '20452'),
	  ('entity_ids[settlements][]', '20453'),
	  ('entity_ids[settlements][]', '20454'),
	  ('entity_ids[settlements][]', '20455'),
	  ('entity_ids[settlements][]', '20456'),
	  ('entity_ids[settlements][]', '20457'),
	  ('entity_ids[settlements][]', '20458'),
	  ('entity_ids[settlements][]', '20459'),
	  ('entity_ids[settlements][]', '20460'),
	  ('entity_ids[settlements][]', '20461'),
	  ('entity_ids[settlements][]', '20462'),
	  ('entity_ids[settlements][]', '20463'),
	  ('entity_ids[settlements][]', '20464'),
	  ('entity_ids[settlements][]', '20465'),
	  ('entity_ids[settlements][]', '20466'),
	  ('entity_ids[settlements][]', '20467'),
	  ('entity_ids[settlements][]', '20468'),
	  ('entity_ids[settlements][]', '20469'),
	  ('entity_ids[settlements][]', '20470'),
	  ('entity_ids[settlements][]', '20471'),
	  ('entity_ids[settlements][]', '20472'),
	  ('entity_ids[settlements][]', '20473'),
	  ('entity_ids[settlements][]', '20474'),
	  ('entity_ids[settlements][]', '20475'),
	  ('entity_ids[settlements][]', '20476'),
	  ('entity_ids[settlements][]', '20477'),
	  ('entity_ids[settlements][]', '20478'),
	  ('entity_ids[settlements][]', '20479'),
	  ('entity_ids[settlements][]', '20480'),
	  ('entity_ids[settlements][]', '20481'),
	  ('entity_ids[settlements][]', '20482'),
	  ('entity_ids[settlements][]', '20483'),
	  ('entity_ids[settlements][]', '20484'),
	  ('entity_ids[settlements][]', '20485'),
	  ('entity_ids[settlements][]', '20486'),
	]

	    yield FormRequest('https://star.worldbank.org/corruption-cases/generate/xlsx', headers=headers, formdata=data, callback=self.parse_excel_settlements)

        def parse_excel_settlements(self, response):
	    excel_response = json.loads(response.body)
	    settlements = excel_response.get('settlements','')
	    for each in settlements:
		case_id = each.get('Case ID', '')
		type_of_settlement = each.get('Type of Settlement')
		jurisdiction = each.get('Jurisdiction of Settlement / Enforcement Agency')
		monetary = each.get('Monetary Sanctions  (Types)')
		offense = each.get('Offenses - Alleged')
		summary = each.get('Summary')
		values = [case_id, jurisdiction, type_of_settlement, monetary, offense, summary]
                self.csv_file.writerow(values)
	
	def parse_assests(self, response):
		url = response.url
		headers = {
		    'origin': 'https://star.worldbank.org',
		    'accept-encoding': 'gzip, deflate, br',
		    'accept-language': 'en-GB,en-US;q=0.9,en;q=0.8',
		    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36',
		    'content-type': 'application/x-www-form-urlencoded; charset=UTF-8',
		    'accept': '*/*',
		    'referer': 'https://star.worldbank.org/corruption-cases/assetrecovery/?f%5B0%5D=bundle%3Aarw',
		    'authority': 'star.worldbank.org',
		    'x-requested-with': 'XMLHttpRequest',
		}

		data = [
		  ('entity_ids[arw][]', '18426'),
		  ('entity_ids[arw][]', '18427'),
		  ('entity_ids[arw][]', '18428'),
		  ('entity_ids[arw][]', '18429'),
		  ('entity_ids[arw][]', '18430'),
		  ('entity_ids[arw][]', '18431'),
		  ('entity_ids[arw][]', '18432'),
		  ('entity_ids[arw][]', '18433'),
		  ('entity_ids[arw][]', '18434'),
		  ('entity_ids[arw][]', '18435'),
		  ('entity_ids[arw][]', '18436'),
		  ('entity_ids[arw][]', '18437'),
		  ('entity_ids[arw][]', '18438'),
		  ('entity_ids[arw][]', '18439'),
		  ('entity_ids[arw][]', '18440'),
		  ('entity_ids[arw][]', '18441'),
		  ('entity_ids[arw][]', '18442'),
		  ('entity_ids[arw][]', '18443'),
		  ('entity_ids[arw][]', '18444'),
		  ('entity_ids[arw][]', '18445'),
		  ('entity_ids[arw][]', '18446'),
		  ('entity_ids[arw][]', '18447'),
		  ('entity_ids[arw][]', '18448'),
		  ('entity_ids[arw][]', '18449'),
		  ('entity_ids[arw][]', '18450'),
		  ('entity_ids[arw][]', '18451'),
		  ('entity_ids[arw][]', '18452'),
		  ('entity_ids[arw][]', '18453'),
		  ('entity_ids[arw][]', '18454'),
		  ('entity_ids[arw][]', '18455'),
		  ('entity_ids[arw][]', '18456'),
		  ('entity_ids[arw][]', '18457'),
		  ('entity_ids[arw][]', '18458'),
		  ('entity_ids[arw][]', '18459'),
		  ('entity_ids[arw][]', '18461'),
		  ('entity_ids[arw][]', '18462'),
		  ('entity_ids[arw][]', '18463'),
		  ('entity_ids[arw][]', '18464'),
		  ('entity_ids[arw][]', '18465'),
		  ('entity_ids[arw][]', '18466'),
		  ('entity_ids[arw][]', '18467'),
		  ('entity_ids[arw][]', '18468'),
		  ('entity_ids[arw][]', '18469'),
		  ('entity_ids[arw][]', '18470'),
		  ('entity_ids[arw][]', '18471'),
		  ('entity_ids[arw][]', '18472'),
		  ('entity_ids[arw][]', '18473'),
		  ('entity_ids[arw][]', '18474'),
		  ('entity_ids[arw][]', '18475'),
		  ('entity_ids[arw][]', '18476'),
		  ('entity_ids[arw][]', '18477'),
		  ('entity_ids[arw][]', '18478'),
		  ('entity_ids[arw][]', '18479'),
		  ('entity_ids[arw][]', '18482'),
		  ('entity_ids[arw][]', '18483'),
		  ('entity_ids[arw][]', '18484'),
		  ('entity_ids[arw][]', '18485'),
		  ('entity_ids[arw][]', '18486'),
		  ('entity_ids[arw][]', '18487'),
		  ('entity_ids[arw][]', '18489'),
		  ('entity_ids[arw][]', '18490'),
		  ('entity_ids[arw][]', '18491'),
		  ('entity_ids[arw][]', '18492'),
		  ('entity_ids[arw][]', '18493'),
		  ('entity_ids[arw][]', '18494'),
		  ('entity_ids[arw][]', '18495'),
		  ('entity_ids[arw][]', '18496'),
		  ('entity_ids[arw][]', '18497'),
		  ('entity_ids[arw][]', '18498'),
		  ('entity_ids[arw][]', '18499'),
		  ('entity_ids[arw][]', '18500'),
		  ('entity_ids[arw][]', '18501'),
		  ('entity_ids[arw][]', '18502'),
		  ('entity_ids[arw][]', '18503'),
		  ('entity_ids[arw][]', '18504'),
		  ('entity_ids[arw][]', '18505'),
		  ('entity_ids[arw][]', '18506'),
		  ('entity_ids[arw][]', '18507'),
		  ('entity_ids[arw][]', '18508'),
		  ('entity_ids[arw][]', '18509'),
		  ('entity_ids[arw][]', '18510'),
		  ('entity_ids[arw][]', '18511'),
		  ('entity_ids[arw][]', '18512'),
		  ('entity_ids[arw][]', '18513'),
		  ('entity_ids[arw][]', '18514'),
		  ('entity_ids[arw][]', '18515'),
		  ('entity_ids[arw][]', '18516'),
		  ('entity_ids[arw][]', '18517'),
		  ('entity_ids[arw][]', '18518'),
		  ('entity_ids[arw][]', '18521'),
		  ('entity_ids[arw][]', '18522'),
		  ('entity_ids[arw][]', '18523'),
		  ('entity_ids[arw][]', '18524'),
		  ('entity_ids[arw][]', '18525'),
		  ('entity_ids[arw][]', '18526'),
		  ('entity_ids[arw][]', '18527'),
		  ('entity_ids[arw][]', '18528'),
		  ('entity_ids[arw][]', '18529'),
		  ('entity_ids[arw][]', '18530'),
		  ('entity_ids[arw][]', '18531'),
		  ('entity_ids[arw][]', '18532'),
		  ('entity_ids[arw][]', '18533'),
		  ('entity_ids[arw][]', '18534'),
		  ('entity_ids[arw][]', '18535'),
		  ('entity_ids[arw][]', '18536'),
		  ('entity_ids[arw][]', '18537'),
		  ('entity_ids[arw][]', '18538'),
		  ('entity_ids[arw][]', '18539'),
		  ('entity_ids[arw][]', '18540'),
		  ('entity_ids[arw][]', '18541'),
		  ('entity_ids[arw][]', '18542'),
		  ('entity_ids[arw][]', '18543'),
		  ('entity_ids[arw][]', '18544'),
		  ('entity_ids[arw][]', '18546'),
		  ('entity_ids[arw][]', '18547'),
		  ('entity_ids[arw][]', '18548'),
		  ('entity_ids[arw][]', '18549'),
		  ('entity_ids[arw][]', '18551'),
		  ('entity_ids[arw][]', '18552'),
		  ('entity_ids[arw][]', '18553'),
		  ('entity_ids[arw][]', '18554'),
		  ('entity_ids[arw][]', '18555'),
		  ('entity_ids[arw][]', '18556'),
		  ('entity_ids[arw][]', '18557'),
		  ('entity_ids[arw][]', '18558'),
		  ('entity_ids[arw][]', '18559'),
		  ('entity_ids[arw][]', '18560'),
		  ('entity_ids[arw][]', '18561'),
		  ('entity_ids[arw][]', '18562'),
		  ('entity_ids[arw][]', '18563'),
		  ('entity_ids[arw][]', '18564'),
		  ('entity_ids[arw][]', '18565'),
		  ('entity_ids[arw][]', '18566'),
		  ('entity_ids[arw][]', '18567'),
		  ('entity_ids[arw][]', '18568'),
		  ('entity_ids[arw][]', '18569'),
		  ('entity_ids[arw][]', '18570'),
		  ('entity_ids[arw][]', '18571'),
		  ('entity_ids[arw][]', '18572'),
		  ('entity_ids[arw][]', '18573'),
		  ('entity_ids[arw][]', '18574'),
		  ('entity_ids[arw][]', '18575'),
		  ('entity_ids[arw][]', '18576'),
		  ('entity_ids[arw][]', '18577'),
		  ('entity_ids[arw][]', '18578'),
		  ('entity_ids[arw][]', '18579'),
		  ('entity_ids[arw][]', '18580'),
		  ('entity_ids[arw][]', '18581'),
		  ('entity_ids[arw][]', '18584'),
		  ('entity_ids[arw][]', '18585'),
		  ('entity_ids[arw][]', '18586'),
		  ('entity_ids[arw][]', '18587'),
		  ('entity_ids[arw][]', '18588'),
		  ('entity_ids[arw][]', '18589'),
		  ('entity_ids[arw][]', '18590'),
		  ('entity_ids[arw][]', '18591'),
		  ('entity_ids[arw][]', '18592'),
		  ('entity_ids[arw][]', '18593'),
		  ('entity_ids[arw][]', '18594'),
		  ('entity_ids[arw][]', '18595'),
		  ('entity_ids[arw][]', '18596'),
		  ('entity_ids[arw][]', '18597'),
		  ('entity_ids[arw][]', '18598'),
		  ('entity_ids[arw][]', '18599'),
		  ('entity_ids[arw][]', '18600'),
		  ('entity_ids[arw][]', '18601'),
		  ('entity_ids[arw][]', '18602'),
		  ('entity_ids[arw][]', '18603'),
		  ('entity_ids[arw][]', '18604'),
		  ('entity_ids[arw][]', '19571'),
		  ('entity_ids[arw][]', '19572'),
		  ('entity_ids[arw][]', '19573'),
		  ('entity_ids[arw][]', '19574'),
		  ('entity_ids[arw][]', '19575'),
		  ('entity_ids[arw][]', '19576'),
		  ('entity_ids[arw][]', '19577'),
		  ('entity_ids[arw][]', '19578'),
		  ('entity_ids[arw][]', '19579'),
		  ('entity_ids[arw][]', '19580'),
		  ('entity_ids[arw][]', '19581'),
		  ('entity_ids[arw][]', '19582'),
		  ('entity_ids[arw][]', '19583'),
		  ('entity_ids[arw][]', '19584'),
		  ('entity_ids[arw][]', '19585'),
		  ('entity_ids[arw][]', '19586'),
		  ('entity_ids[arw][]', '19587'),
		  ('entity_ids[arw][]', '19588'),
		  ('entity_ids[arw][]', '19589'),
		  ('entity_ids[arw][]', '19590'),
		  ('entity_ids[arw][]', '19591'),
		  ('entity_ids[arw][]', '19592'),
		  ('entity_ids[arw][]', '19594'),
		  ('entity_ids[arw][]', '19595'),
		  ('entity_ids[arw][]', '19596'),
		  ('entity_ids[arw][]', '19597'),
		  ('entity_ids[arw][]', '19598'),
		  ('entity_ids[arw][]', '19599'),
		  ('entity_ids[arw][]', '19600'),
		  ('entity_ids[arw][]', '20306'),
		  ('entity_ids[arw][]', '20307'),
		  ('entity_ids[arw][]', '20308'),
		  ('entity_ids[arw][]', '20309'),
		  ('entity_ids[arw][]', '20310'),
		  ('entity_ids[arw][]', '20311'),
		  ('entity_ids[arw][]', '20312'),
		  ('entity_ids[arw][]', '20313'),
		  ('entity_ids[arw][]', '20314'),
		  ('entity_ids[arw][]', '20315'),
		  ('entity_ids[arw][]', '20316'),
		  ('entity_ids[arw][]', '20317'),
		  ('entity_ids[arw][]', '20318'),
		  ('entity_ids[arw][]', '20319'),
		  ('entity_ids[arw][]', '20320'),
		  ('entity_ids[arw][]', '20321'),
		  ('entity_ids[arw][]', '20322'),
		  ('entity_ids[arw][]', '20324'),
		  ('entity_ids[arw][]', '20325'),
		  ('entity_ids[arw][]', '20326'),
		  ('entity_ids[arw][]', '20327'),
		  ('entity_ids[arw][]', '20328'),
		  ('entity_ids[arw][]', '20329'),
		  ('entity_ids[arw][]', '20330'),
		  ('entity_ids[arw][]', '20331'),
		  ('entity_ids[arw][]', '20332'),
		  ('entity_ids[arw][]', '20333'),
		  ('entity_ids[arw][]', '20334'),
		  ('entity_ids[arw][]', '20336'),
		  ('entity_ids[arw][]', '20337'),
		  ('entity_ids[arw][]', '20338'),
		  ('entity_ids[arw][]', '20339'),
		  ('entity_ids[arw][]', '20340'),
		  ('entity_ids[arw][]', '20341'),
		  ('entity_ids[arw][]', '20342'),
		  ('entity_ids[arw][]', '20345'),
		  ('entity_ids[arw][]', '20346'),
		  ('entity_ids[arw][]', '20349'),
		  ('entity_ids[arw][]', '20487'),
		  ('entity_ids[arw][]', '20488'),
		  ('entity_ids[arw][]', '20489'),
		  ('entity_ids[arw][]', '20490'),
		  ('entity_ids[arw][]', '20494'),
		  ('entity_ids[arw][]', '20496'),
		  ('entity_ids[arw][]', '20497'),
		  ('entity_ids[arw][]', '20498'),
		  ('entity_ids[arw][]', '20499'),
		]

		yield FormRequest('https://star.worldbank.org/corruption-cases/generate/xlsx', headers=headers, formdata=data, callback =self.parse_excel_assests)

	def parse_excel_assests(self, response):
            asset_response = json.loads(response.body)
            assets = asset_response.get('arw','')
            for each in assets:
		case_title =  each.get('Case Title (Name of Public Official or Entity Allegedly Involved)')
		jurisdiction = each.get('Jurisdiction of Origin: Investigative Agency')
		uncac = each.get('UNCAC Offenses Implicated')
		money_laundering = each.get('Money laundering Implicated')
		asser_recovery = each.get('Legal Basis for Asset Recovery')
		contributing_factors = each.get('Contributing Factors in Asset Recovery')
		assets_adjudicated = each.get('Assets Adjudicated, Not Yet Returned (USD)')
		case_summary = each.get('Case Summary')
		disposition = each.get('Disposition of Criminal Case(s)')
		values = [case_title, jurisdiction, uncac, money_laundering, asser_recovery, contributing_factors, assets_adjudicated, case_summary, disposition]
		self.document_file.writerow(values)
